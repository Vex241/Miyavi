-- Miyavi-AK: Muscle Legends Kill All + Auto Server Hop
-- PlaceId: 3623096087
-- Features: Kill all players, auto-equip punch, server hop every 10s, no whitelist

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local VirtualUser = game:GetService("VirtualUser")

-- Configuration
_G.placeId = 3623096087
_G.serverHopDelay = 10 -- seconds

-- Auto-equip punch tool
local function autoEquipPunch()
    local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
    if punch then
        local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
        if humanoid then
            humanoid:EquipTool(punch)
            return true
        end
    end
    return false
end

-- Server hop function
local function serverHop()
    print("üîÑ Starting server hop...")
    
    local success, response = pcall(function()
        local url = string.format("https://games.roblox.com/v1/games/%d/servers/Public?sortOrder=Desc&limit=100", _G.placeId)
        return HttpService:JSONDecode(HttpService:GetAsync(url, true))
    end)
    
    if success and response and response.data then
        local available = {}
        for _, server in ipairs(response.data) do
            if server.id ~= game.JobId and server.playing and server.maxPlayers and server.playing < server.maxPlayers then
                table.insert(available, server)
            end
        end
        
        if #available > 0 then
            local target = available[math.random(1, #available)]
            print("‚úÖ Teleporting to server: " .. target.id)
            TeleportService:TeleportToPlaceInstance(_G.placeId, target.id, LocalPlayer)
            return
        end
    end
    
    -- Fallback
    warn("‚ö†Ô∏è Using fallback teleport...")
    TeleportService:Teleport(_G.placeId, LocalPlayer)
end

-- Start server hop countdown
task.spawn(function()
    for i = _G.serverHopDelay, 1, -1 do
        print("‚è±Ô∏è Server hop in " .. i .. " seconds")
        task.wait(1)
    end
    print("üöÄ Server hopping now!")
    serverHop()
end)

-- Kill function
local function killPlayer(target)
    if not target or target == LocalPlayer then return end
    
    -- Ensure we have punch equipped
    autoEquipPunch()
    
    -- Primary kill method
    local muscleEvent = LocalPlayer:FindFirstChild("muscleEvent")
    if muscleEvent then
        muscleEvent:FireServer("punch", "leftHand")
        muscleEvent:FireServer("punch", "rightHand")
    end
    
    -- Backup touch method
    pcall(function()
        local targetChar = target.Character
        local myChar = LocalPlayer.Character
        if targetChar and myChar then
            local targetHRP = targetChar:FindFirstChild("HumanoidRootPart")
            local leftHand = myChar:FindFirstChild("LeftHand")
            if targetHRP and leftHand then
                firetouchinterest(targetHRP, leftHand, 0)
                firetouchinterest(targetHRP, leftHand, 1)
            end
        end
    end)
end

-- Simple UI
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/ISPPs54/Ui/refs/heads/main/eeee", true))()
local Window = Library:AddWindow("Miyavi-AK", {
    main_color = Color3.fromRGB(255, 0, 0),
    min_size = Vector2.new(320, 180),
    can_resize = false
})

local MainTab = Window:AddTab("Main")
MainTab:AddLabel("Kill All Mode").TextSize = 24

local statusLabel = MainTab:AddLabel("Status: Starting...")
local timerLabel = MainTab:AddLabel(string.format("Server Hop: %ds", _G.serverHopDelay))

-- Main kill loop
task.spawn(function()
    statusLabel.Text = "‚úÖ Status: Running"
    
    -- Ensure character loads first
    LocalPlayer.CharacterAdded:Wait()
    task.wait(1)
    autoEquipPunch()
    
    while true do
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                killPlayer(player)
            end
        end
        task.wait(0.1)
    end
end)

-- Character respawn handler
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    autoEquipPunch()
    statusLabel.Text = "‚úÖ Status: Running (Respawned)"
end)

-- Anti-AFK
LocalPlayer.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

-- Cleanup on GUI close
game:GetService("CoreGui").ChildRemoved:Connect(function(child)
    if child.Name:find("Miyavi") then
        _G.killAllEnabled = false
    end
end)

print("‚úÖ Miyavi-AK Loaded")
print("üéØ Kill All: ACTIVE")
print("‚è±Ô∏è Server Hop: " .. _G.serverHopDelay .. " seconds")
print("üîß Auto-Equip: ENABLED")
